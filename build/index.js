(()=>{"use strict";window.wp.element,window.wp.data,window.wp.i18n,window.wp.components,window.ReactJSXRuntime;const e=()=>{const e=document.querySelector(".wc-block-components-shipping-rates-control");if(!e)return;if(!e.querySelector('input[value*="wuunder_pickup"]:checked')){const e=document.querySelector(".wuunder-pickup-block-container");return void(e&&e.remove())}if(document.querySelector(".wuunder-pickup-block-container"))return;const t=document.createElement("div");t.className="wuunder-pickup-block-container",t.innerHTML='\n        <div style="margin-top: 16px; padding: 12px; background: #f7f7f7; border-radius: 4px;">\n            <button type="button" class="wp-block-button__link wp-element-button" id="wuunder-select-pickup">\n                Select pick-up location\n            </button>\n        </div>\n    ',e.appendChild(t),t.querySelector("#wuunder-select-pickup").addEventListener("click",()=>{o()})},o=()=>{const e=(e=>{const o=[e.street,e.postcode,e.city,e.country].filter(Boolean),t=o.length>0?o.join(", "):"Netherlands";return`https://my.wearewuunder.com/parcelshop_locator/iframe?${new URLSearchParams({address:t,availableCarriers:"dhl,postnl,ups",primary_color:"52ba69",language:"nl"}).toString()}`})((()=>{let e={street:"",city:"",postcode:"",country:"NL"};const o={street:['input[name="billing_address_1"]','input[id*="billing-address_1"]','input[id*="address_1"]','input[id*="address-1"]','.wp-block-woocommerce-checkout-billing-address-block input[placeholder*="address" i]','.wp-block-woocommerce-checkout-contact-information-block input[placeholder*="address" i]'],city:['input[name="billing_city"]','input[id*="billing-city"]','input[id*="city"]','.wp-block-woocommerce-checkout-billing-address-block input[placeholder*="city" i]','.wp-block-woocommerce-checkout-contact-information-block input[placeholder*="city" i]'],postcode:['input[name="billing_postcode"]','input[id*="billing-postcode"]','input[id*="postcode"]','input[id*="postal"]','.wp-block-woocommerce-checkout-billing-address-block input[placeholder*="postal" i]','.wp-block-woocommerce-checkout-billing-address-block input[placeholder*="zip" i]','.wp-block-woocommerce-checkout-contact-information-block input[placeholder*="postal" i]','.wp-block-woocommerce-checkout-contact-information-block input[placeholder*="zip" i]'],country:['select[name="billing_country"]','select[id*="billing-country"]','select[id*="country"]',".wp-block-woocommerce-checkout-billing-address-block select",".wp-block-woocommerce-checkout-contact-information-block select"]};return Object.keys(o).forEach(t=>{for(const n of o[t]){const o=document.querySelector(n);if(o&&o.value&&""!==o.value.trim()){e[t]=o.value.trim();break}}}),e})()),o=document.createElement("div");o.className="wuunder-pickup-modal-overlay",o.innerHTML=`\n        <div class="wuunder-pickup-modal">\n            <iframe src="${e}" class="wuunder-pickup-iframe"></iframe>\n        </div>\n    `,o.id="wuunder-pickup-iframe-container",document.body.appendChild(o),document.body.style.overflow="hidden",window.addEventListener("message",t)},t=e=>{if("https://my.wearewuunder.com"===e.origin)if(e.data&&"servicePointPickerSelected"===e.data.type){const o=n(e.data);c(o),i(o),closePickupModal()}else e.data&&"servicePointPickerClose"===e.data.type&&closePickupModal()},n=e=>{let o="";if(e.parcelshopId){const t=e.parcelshopId.split(":");t[0]&&(o=t[0].toLowerCase().replace("_",""))}return{id:e.parcelshopId||"",name:e.address?.business||"",street:(e.address?.street_name||"")+" "+(e.address?.house_number||""),postcode:e.address?.zip_code||"",city:e.address?.locality||"",country:e.address?.country_code||"",carrier:o,opening_hours:e.openingHours||[]}},c=e=>{let o=document.querySelector("#wuunder_selected_pickup_point");o||(o=document.createElement("input"),o.type="hidden",o.id="wuunder_selected_pickup_point",o.name="wuunder_selected_pickup_point",document.querySelector("form").appendChild(o)),o.value=JSON.stringify(e)},i=e=>{const o=document.querySelector(".wuunder-pickup-block-container");o&&(o.innerHTML=`\n            <div style="margin-top: 16px; padding: 12px; background: #f7f7f7; border-radius: 4px;">\n                <div style="margin-bottom: 8px;">\n                    <strong>${e.name}</strong><br>\n                    ${e.street}<br>\n                    ${e.postcode} ${e.city}\n                </div>\n                <button type="button" class="wp-block-button__link wp-element-button" onclick="openPickupModal()">\n                    Change\n                </button>\n            </div>\n        `)};window.closePickupModal=()=>{const e=document.querySelector("#wuunder-pickup-iframe-container");e&&e.remove(),document.body.style.overflow="",window.removeEventListener("message",t)},window.openPickupModal=o;const r=()=>{setTimeout(e,1e3);const o=new MutationObserver(()=>{e(),d()}),t=document.querySelector(".wc-block-checkout");t?o.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["checked"]}):setTimeout(r,2e3),d()},d=()=>{document.querySelectorAll('.wc-block-components-shipping-rates-control input[type="radio"]').forEach(e=>{e.removeEventListener("change",l),e.addEventListener("change",l)})},l=o=>{setTimeout(()=>{e()},100)};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r()})();